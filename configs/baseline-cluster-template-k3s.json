{
  "name": "baseline-k3s",
  "version": "v0.0.10",
  "kubernetesVersion": "v1.33.5+k3s1",
  "description": "Baseline Cluster Template for k3s",
  "controlplaneprovidertype": "k3s",
  "infraprovidertype": "intel",
  "clusterconfiguration": {
    "kind": "KThreesControlPlaneTemplate",
    "apiVersion": "controlplane.cluster.x-k8s.io/v1beta2",
    "metadata": {
      "labels": {
        "cpumanager": "true"
      }
    },
    "spec": {
      "template": {
        "spec": {
          "kthreesConfigSpec": {
            "files": [
              {
                "path": "/var/lib/rancher/k3s/server/psa.yaml",
                "contentFrom": {
                  "secret": {
                    "name": "pod-security-admission-config",
                    "key": "baseline.yaml"
                  }
                }
              },
              {
                "path": "/var/lib/rancher/k3s/agent/etc/containerd/config.toml.tmpl",
                "content": "{{ template \\\"base\\\" . }}\n\n[plugins.\\\"io.containerd.grpc.v1.cri\\\".containerd.runtimes.kata-qemu]\n  runtime_type = \\\"io.containerd.kata-qemu.v2\\\"\n  runtime_path = \\\"/opt/kata/bin/containerd-shim-kata-v2\\\"\n  privileged_without_host_devices = true\n  pod_annotations = [\\\"io.katacontainers.*\\\"]\n\n[plugins.\\\"io.containerd.grpc.v1.cri\\\".containerd.runtimes.kata-qemu.options]\n  ConfigPath = \\\"/opt/kata/share/defaults/kata-containers/configuration-qemu.toml\\\"\n\n[plugins.\\\"io.containerd.nri.v1.nri\\\"]\n  disable = false\n  disable_connections = false\n  plugin_config_path = \\\"/etc/nri/conf.d\\\"\n  plugin_path = \\\"/opt/nri/plugins\\\"\n  plugin_registration_timeout = \\\"5s\\\"\n  plugin_request_timeout = \\\"2s\\\"\n  socket_path = \\\"/var/run/nri/nri.sock\\\""
              },
              {
                "path": "/etc/rancher/k3s/config.yaml.d/kube-apiserver-arg.yaml",
                "content": "kube-apiserver-arg:\n- tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n- anonymous-auth=false"
              },
              {
                "path": "/etc/rancher/k3s/config.yaml.d/etcd-arg.yaml",
                "content": "etcd-arg:\n- cipher-suites=[TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384]"
              },
              {
                "content": "PATH=\"/var/lib/rancher/k3s/bin:$PATH\"\nKUBECONFIG=\"/etc/rancher/k3s/k3s.yaml\"",
                "path": "/etc/environment.d/50-k3s.conf",
                "permissions": "0644"
              }
            ],
            "agentConfig": {
              "airGapped": true,
              "kubeletArgs": [
                "--topology-manager-policy=best-effort",
                "--cpu-manager-policy=static",
                "--reserved-cpus=1",
                "--max-pods=250",
                "--tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
                "--pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests"
              ]
            },
            "preK3sCommands": [
              "mkdir -p /etc/systemd/system/k3s-server.service.d",
              "echo '[Service]\nEnvironmentFile=/etc/environment' > /etc/systemd/system/k3s-server.service.d/override.conf",
              "mkdir -p /var/lib/rancher/k3s/bin",
              "export INSTALL_K3S_BIN_DIR=/var/lib/rancher/k3s/bin",
              "ln -sf /var/lib/rancher/k3s/bin/k3s /usr/local/bin/kubectl"
            ],
            "postK3sCommands": [],
            "serverConfig": {
              "kubeApiServerArg": [
                "--tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
                "--admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml"
              ],
              "kubeControllerManagerArgs": [],
              "kubeSchedulerArgs": [],
              "disableCloudController": false,
              "disableComponents": [
                "metrics-server",
                "traefik",
                "etcd-proxy",
                "servicelb"
              ]
            },
            "version": "v1.33.5+k3s1"
          }
        }
      }
    }
  },
  "clusterNetwork": {
    "pods": {
      "cidrBlocks": [
        "10.45.0.0/16"
      ]
    },
    "services": {
      "cidrBlocks": [
        "10.46.0.0/16"
      ]
    }
  },
  "cluster-labels": {}
}